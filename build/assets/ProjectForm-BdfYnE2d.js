import{a as m,r as c,h as U,n as k,c as r,b as l,w as j,e as s,v as o,y as g,F as q,p as x,i as M,t as v,k as R,l as S,q as f,f as B,o as d,s as D}from"./app-PrQ92K9m.js";const F={class:"max-w-3xl"},N={class:"card"},C={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},I=["value"],P=["value"],T={class:"flex gap-4"},E=["disabled"],A={__name:"ProjectForm",setup(L){const i=U(),V=B(),u=m(!1),b=m([]),y=m([]),a=c({name:"",lead_id:i.query.lead_id?parseInt(i.query.lead_id):null,quotation_id:i.query.quotation_id?parseInt(i.query.quotation_id):null,manager_id:null,contract_value:0,start_date:"",expected_end_date:"",address:"",description:""}),_=async()=>{const[n,e]=await Promise.all([f.get("/leads",{params:{per_page:100}}),f.get("/users",{params:{role:"manager"}})]);b.value=n.data.data,y.value=e.data.data},w=async()=>{var n,e;u.value=!0;try{await f.post("/projects",a),V.push("/projects")}catch(p){alert(((e=(n=p.response)==null?void 0:n.data)==null?void 0:e.message)||"حدث خطأ")}finally{u.value=!1}};return k(_),(n,e)=>{const p=S("router-link");return d(),r("div",F,[l("div",N,[e[19]||(e[19]=l("div",{class:"card-header"},[l("h3",{class:"font-semibold"},"إنشاء مشروع جديد")],-1)),l("form",{onSubmit:j(w,["prevent"]),class:"card-body space-y-6"},[l("div",C,[l("div",null,[e[8]||(e[8]=l("label",{class:"form-label"},"اسم المشروع *",-1)),s(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.name=t),type:"text",class:"form-input",required:""},null,512),[[o,a.name]])]),l("div",null,[e[10]||(e[10]=l("label",{class:"form-label"},"العميل *",-1)),s(l("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.lead_id=t),class:"form-input",required:""},[e[9]||(e[9]=l("option",{value:null},"-- اختر --",-1)),(d(!0),r(q,null,x(b.value,t=>(d(),r("option",{key:t.id,value:t.id},v(t.name),9,I))),128))],512),[[g,a.lead_id]])]),l("div",null,[e[12]||(e[12]=l("label",{class:"form-label"},"مدير المشروع *",-1)),s(l("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>a.manager_id=t),class:"form-input",required:""},[e[11]||(e[11]=l("option",{value:null},"-- اختر --",-1)),(d(!0),r(q,null,x(y.value,t=>(d(),r("option",{key:t.id,value:t.id},v(t.name),9,P))),128))],512),[[g,a.manager_id]])]),l("div",null,[e[13]||(e[13]=l("label",{class:"form-label"},"قيمة العقد *",-1)),s(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>a.contract_value=t),type:"number",class:"form-input",min:"0",required:""},null,512),[[o,a.contract_value]])]),l("div",null,[e[14]||(e[14]=l("label",{class:"form-label"},"تاريخ البدء *",-1)),s(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>a.start_date=t),type:"date",class:"form-input",required:""},null,512),[[o,a.start_date]])]),l("div",null,[e[15]||(e[15]=l("label",{class:"form-label"},"تاريخ الانتهاء المتوقع *",-1)),s(l("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>a.expected_end_date=t),type:"date",class:"form-input",required:""},null,512),[[o,a.expected_end_date]])])]),l("div",null,[e[16]||(e[16]=l("label",{class:"form-label"},"العنوان *",-1)),s(l("textarea",{"onUpdate:modelValue":e[6]||(e[6]=t=>a.address=t),class:"form-input",rows:"2",required:""},null,512),[[o,a.address]])]),l("div",null,[e[17]||(e[17]=l("label",{class:"form-label"},"الوصف",-1)),s(l("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>a.description=t),class:"form-input",rows:"3"},null,512),[[o,a.description]])]),l("div",T,[l("button",{type:"submit",disabled:u.value,class:"btn btn-primary"},v(u.value?"جاري الحفظ...":"حفظ"),9,E),M(p,{to:"/projects",class:"btn btn-secondary"},{default:R(()=>[...e[18]||(e[18]=[D("إلغاء",-1)])]),_:1})])],32)])])}}};export{A as default};
