import{a as p,r as k,h as _,n as U,c as o,b as s,w as S,e as a,y as g,F as x,p as q,v as d,i as M,t as u,k as R,l as B,q as v,f as D,o as r,s as F}from"./app-PrQ92K9m.js";const N={class:"max-w-2xl"},C={class:"card"},T=["value"],E=["value"],I={class:"flex gap-4"},L=["disabled"],z={__name:"SiteVisitForm",setup(P){const f=_(),w=D(),i=p(!1),b=p([]),y=p([]),t=k({lead_id:f.query.lead_id?parseInt(f.query.lead_id):null,engineer_id:null,scheduled_at:"",address:"",client_requirements:"",notes:""}),V=async()=>{const[n,e]=await Promise.all([v.get("/leads",{params:{per_page:100}}),v.get("/users-engineers")]);b.value=n.data.data,y.value=e.data.data},c=async()=>{var n,e;i.value=!0;try{await v.post("/site-visits",t),w.push("/site-visits")}catch(m){alert(((e=(n=m.response)==null?void 0:n.data)==null?void 0:e.message)||"حدث خطأ")}finally{i.value=!1}};return U(V),(n,e)=>{const m=B("router-link");return r(),o("div",N,[s("div",C,[e[15]||(e[15]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"جدولة معاينة جديدة")],-1)),s("form",{onSubmit:S(c,["prevent"]),class:"card-body space-y-6"},[s("div",null,[e[7]||(e[7]=s("label",{class:"form-label"},"العميل *",-1)),a(s("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.lead_id=l),class:"form-input",required:""},[e[6]||(e[6]=s("option",{value:null},"-- اختر العميل --",-1)),(r(!0),o(x,null,q(b.value,l=>(r(),o("option",{key:l.id,value:l.id},u(l.name)+" - "+u(l.phone),9,T))),128))],512),[[g,t.lead_id]])]),s("div",null,[e[9]||(e[9]=s("label",{class:"form-label"},"المهندس *",-1)),a(s("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.engineer_id=l),class:"form-input",required:""},[e[8]||(e[8]=s("option",{value:null},"-- اختر المهندس --",-1)),(r(!0),o(x,null,q(y.value,l=>(r(),o("option",{key:l.id,value:l.id},u(l.name),9,E))),128))],512),[[g,t.engineer_id]])]),s("div",null,[e[10]||(e[10]=s("label",{class:"form-label"},"موعد المعاينة *",-1)),a(s("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.scheduled_at=l),type:"datetime-local",class:"form-input",required:""},null,512),[[d,t.scheduled_at]])]),s("div",null,[e[11]||(e[11]=s("label",{class:"form-label"},"العنوان *",-1)),a(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.address=l),class:"form-input",rows:"2",required:""},null,512),[[d,t.address]])]),s("div",null,[e[12]||(e[12]=s("label",{class:"form-label"},"متطلبات العميل",-1)),a(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>t.client_requirements=l),class:"form-input",rows:"3"},null,512),[[d,t.client_requirements]])]),s("div",null,[e[13]||(e[13]=s("label",{class:"form-label"},"ملاحظات",-1)),a(s("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>t.notes=l),class:"form-input",rows:"2"},null,512),[[d,t.notes]])]),s("div",I,[s("button",{type:"submit",disabled:i.value,class:"btn btn-primary"},u(i.value?"جاري الحفظ...":"حفظ"),9,L),M(m,{to:"/site-visits",class:"btn btn-secondary"},{default:R(()=>[...e[14]||(e[14]=[F("إلغاء",-1)])]),_:1})])],32)])])}}};export{z as default};
