import{a as C,n as j,c as n,d as r,b as s,t as o,x as D,s as i,F as $,p as N,i as F,k as V,l as Y,q as c,h as B,o as d}from"./app-Cs6lHxPq.js";import{d as E}from"./dayjs.min-CxMP4GVf.js";const M={key:0,class:"space-y-6"},P={class:"flex items-center justify-between"},G={class:"text-sm text-gray-500"},L={class:"text-2xl font-bold"},S={class:"flex items-center gap-3"},q={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},z={class:"lg:col-span-2 space-y-6"},I={class:"card"},R={class:"card-body"},T={class:"grid grid-cols-2 gap-4 text-sm mb-6"},A={class:"mr-2 font-medium"},H={class:"mr-2"},J={class:"mr-2 font-bold text-primary-600"},K={class:"mr-2"},O={class:"mr-2"},Q={key:0,class:"mb-4"},U={class:"text-sm text-gray-600 whitespace-pre-line"},W={key:1},X={class:"text-sm text-gray-600 whitespace-pre-line"},Z={class:"card"},ss={class:"card-body"},ts={key:0,class:"text-center text-gray-500 py-4"},es={key:1,class:"space-y-3"},as={class:"font-medium"},os={class:"text-sm text-gray-500"},ns={class:"text-left"},ds={class:"font-bold"},ls={class:"text-xs text-gray-500"},is={class:"space-y-6"},rs={class:"card"},cs={class:"card-body space-y-3"},us={class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},ps={key:0,class:"badge badge-success"},_s={key:1,class:"badge badge-gray"},ms={class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},vs={key:0,class:"badge badge-success"},gs={key:1,class:"badge badge-gray"},ys={class:"card"},bs={class:"card-body space-y-3"},ws={__name:"ContractDetails",setup(fs){const b=B(),e=C(null),u=async()=>{const{data:a}=await c.get(`/contracts/${b.params.id}`);e.value=a.data},f=async a=>{await c.put(`/contracts/${e.value.id}`,{status:a}),u()},x=async()=>{const{data:a}=await c.post(`/contracts/${e.value.id}/pdf`);window.open(a.data.pdf_url,"_blank")},p=a=>E(a).format("YYYY/MM/DD"),_=a=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(a),k=a=>({draft:"مسودة",pending_signature:"بانتظار التوقيع",active:"نشط",completed:"مكتمل"})[a]||a,w=a=>({draft:"badge-gray",pending_signature:"badge-warning",active:"badge-success",completed:"badge-info"})[a]||"badge-gray";return j(u),(a,t)=>{var m,v,g,y;const h=Y("router-link");return e.value?(d(),n("div",M,[s("div",P,[s("div",null,[s("p",G,o(e.value.contract_number),1),s("h2",L,o(e.value.title),1)]),s("div",S,[s("span",{class:D([w(e.value.status),"badge text-base px-4 py-2"])},o(k(e.value.status)),3),s("button",{onClick:x,class:"btn btn-primary"},"تحميل PDF")])]),s("div",q,[s("div",z,[s("div",I,[t[13]||(t[13]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"تفاصيل العقد")],-1)),s("div",R,[s("div",T,[s("div",null,[t[1]||(t[1]=s("span",{class:"text-gray-500"},"المشروع:",-1)),t[2]||(t[2]=i()),s("span",A,o((m=e.value.project)==null?void 0:m.name),1)]),s("div",null,[t[3]||(t[3]=s("span",{class:"text-gray-500"},"العميل:",-1)),t[4]||(t[4]=i()),s("span",H,o((g=(v=e.value.project)==null?void 0:v.lead)==null?void 0:g.name),1)]),s("div",null,[t[5]||(t[5]=s("span",{class:"text-gray-500"},"قيمة العقد:",-1)),t[6]||(t[6]=i()),s("span",J,o(_(e.value.total_value)),1)]),s("div",null,[t[7]||(t[7]=s("span",{class:"text-gray-500"},"تاريخ البدء:",-1)),t[8]||(t[8]=i()),s("span",K,o(p(e.value.start_date)),1)]),s("div",null,[t[9]||(t[9]=s("span",{class:"text-gray-500"},"تاريخ الانتهاء:",-1)),t[10]||(t[10]=i()),s("span",O,o(p(e.value.end_date)),1)])]),e.value.scope_of_work?(d(),n("div",Q,[t[11]||(t[11]=s("h4",{class:"font-medium mb-2"},"نطاق العمل",-1)),s("p",U,o(e.value.scope_of_work),1)])):r("",!0),e.value.terms_conditions?(d(),n("div",W,[t[12]||(t[12]=s("h4",{class:"font-medium mb-2"},"الشروط والأحكام",-1)),s("p",X,o(e.value.terms_conditions),1)])):r("",!0)])]),s("div",Z,[t[14]||(t[14]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"شروط الدفع")],-1)),s("div",ss,[((y=e.value.payment_terms)==null?void 0:y.length)===0?(d(),n("div",ts,"لا توجد شروط دفع")):(d(),n("div",es,[(d(!0),n($,null,N(e.value.payment_terms,l=>(d(),n("div",{key:l.id,class:"p-3 bg-gray-50 rounded-lg flex items-center justify-between"},[s("div",null,[s("p",as,o(l.description),1),s("p",os,o(l.milestone),1)]),s("div",ns,[s("p",ds,o(_(l.amount)),1),s("p",ls,o(l.percentage)+"%",1)])]))),128))]))])])]),s("div",is,[s("div",rs,[t[17]||(t[17]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"حالة التوقيع")],-1)),s("div",cs,[s("div",us,[t[15]||(t[15]=s("span",null,"توقيع الشركة",-1)),e.value.company_signed_at?(d(),n("span",ps,"تم")):(d(),n("span",_s,"لم يتم"))]),s("div",ms,[t[16]||(t[16]=s("span",null,"توقيع العميل",-1)),e.value.client_signed_at?(d(),n("span",vs,"تم")):(d(),n("span",gs,"لم يتم"))])])]),s("div",ys,[t[19]||(t[19]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"إجراءات")],-1)),s("div",bs,[e.value.status==="draft"?(d(),n("button",{key:0,onClick:t[0]||(t[0]=l=>f("pending_signature")),class:"btn btn-primary w-full"},"إرسال للتوقيع")):r("",!0),F(h,{to:`/invoices/create?contract_id=${e.value.id}&project_id=${e.value.project_id}`,class:"btn btn-secondary w-full block text-center"},{default:V(()=>[...t[18]||(t[18]=[i("إنشاء فاتورة",-1)])]),_:1},8,["to"])])])])])])):r("",!0)}}};export{ws as default};
