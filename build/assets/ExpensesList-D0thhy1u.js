import{a as u,r as q,n as C,c as a,b as t,d as E,F as x,p as g,w as U,e as i,y as w,z as N,v as p,q as m,o as r,t as o,x as S}from"./app-Cs6lHxPq.js";import{d as j}from"./dayjs.min-CxMP4GVf.js";const z={class:"space-y-6"},B={class:"flex items-center justify-between"},F={class:"card"},L={class:"table-container"},G={class:"table"},P={class:"font-medium"},R={class:"text-red-600 font-medium"},_={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},$={class:"bg-white rounded-xl p-6 w-full max-w-md"},I=["value"],T={class:"flex gap-3"},K={__name:"ExpensesList",setup(A){const b=u([]),f=u([]),d=u(!1),l=q({category:"materials",project_id:null,description:"",amount:0,expense_date:j().format("YYYY-MM-DD")}),v=async()=>{const[n,e]=await Promise.all([m.get("/expenses"),m.get("/projects")]);b.value=n.data.data,f.value=e.data.data},M=async()=>{await m.post("/expenses",l),d.value=!1,v()},k=n=>j(n).format("YYYY/MM/DD"),D=n=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(n),V=n=>({pending:"معلق",approved:"موافق عليه",rejected:"مرفوض"})[n]||n,Y=n=>({pending:"badge-warning",approved:"badge-success",rejected:"badge-danger"})[n]||"badge-gray";return C(v),(n,e)=>(r(),a("div",z,[t("div",B,[e[7]||(e[7]=t("h2",{class:"text-xl font-bold"},"المصروفات",-1)),t("button",{onClick:e[0]||(e[0]=s=>d.value=!0),class:"btn btn-primary"},"تسجيل مصروف")]),t("div",F,[t("div",L,[t("table",G,[e[8]||(e[8]=t("thead",null,[t("tr",null,[t("th",null,"الرقم"),t("th",null,"التصنيف"),t("th",null,"الوصف"),t("th",null,"المشروع"),t("th",null,"المبلغ"),t("th",null,"الحالة"),t("th",null,"التاريخ")])],-1)),t("tbody",null,[(r(!0),a(x,null,g(b.value,s=>{var c,y;return r(),a("tr",{key:s.id},[t("td",P,o(s.expense_number),1),t("td",null,o(s.category),1),t("td",null,o((c=s.description)==null?void 0:c.substring(0,30))+"...",1),t("td",null,o(((y=s.project)==null?void 0:y.name)||"-"),1),t("td",R,o(D(s.amount)),1),t("td",null,[t("span",{class:S([Y(s.status),"badge"])},o(V(s.status)),3)]),t("td",null,o(k(s.expense_date)),1)])}),128))])])])]),d.value?(r(),a("div",_,[t("div",$,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold mb-4"},"تسجيل مصروف",-1)),t("form",{onSubmit:U(M,["prevent"]),class:"space-y-4"},[t("div",null,[e[10]||(e[10]=t("label",{class:"form-label"},"التصنيف *",-1)),i(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.category=s),class:"form-input",required:""},[...e[9]||(e[9]=[N('<option value="materials">خامات</option><option value="labor">عمالة</option><option value="transport">نقل</option><option value="equipment">معدات</option><option value="other">أخرى</option>',5)])],512),[[w,l.category]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"form-label"},"المشروع",-1)),i(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.project_id=s),class:"form-input"},[e[11]||(e[11]=t("option",{value:null},"-- عام --",-1)),(r(!0),a(x,null,g(f.value,s=>(r(),a("option",{key:s.id,value:s.id},o(s.name),9,I))),128))],512),[[w,l.project_id]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"form-label"},"الوصف *",-1)),i(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.description=s),class:"form-input",rows:"2",required:""},null,512),[[p,l.description]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"form-label"},"المبلغ *",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.amount=s),type:"number",class:"form-input",min:"0",required:""},null,512),[[p,l.amount]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"form-label"},"التاريخ *",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>l.expense_date=s),type:"date",class:"form-input",required:""},null,512),[[p,l.expense_date]])]),t("div",T,[e[16]||(e[16]=t("button",{type:"submit",class:"btn btn-primary"},"حفظ",-1)),t("button",{type:"button",onClick:e[6]||(e[6]=s=>d.value=!1),class:"btn btn-secondary"},"إلغاء")])],32)])])):E("",!0)]))}};export{K as default};
