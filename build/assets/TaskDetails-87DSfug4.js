import{a as m,n as H,c as o,d as i,b as s,t as n,x as f,s as g,F as C,p as $,w as D,e as M,v as Y,q as u,h as U,o as d}from"./app-PrQ92K9m.js";import{d as j}from"./dayjs.min-CxMP4GVf.js";const E={key:0,class:"max-w-4xl space-y-6"},I={class:"flex items-center justify-between"},R={class:"text-2xl font-bold"},A={class:"text-gray-500"},G={class:"flex items-center gap-3"},J={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},K={class:"lg:col-span-2 space-y-6"},O={class:"card"},P={class:"card-body"},Q={key:0,class:"text-gray-600 mb-4"},W={class:"grid grid-cols-2 gap-4 text-sm"},X={class:"mr-2"},Z={class:"mr-2"},ss={class:"mr-2"},ts={class:"mr-2"},es={class:"card"},as={class:"card-header flex items-center justify-between"},ls={class:"card-body"},ns={key:0,class:"text-center text-gray-500 py-4"},os={key:1,class:"space-y-2"},ds=["checked","onChange"],is={class:"card"},rs={class:"card-body space-y-4"},cs={class:"text-sm"},us={class:"text-xs text-gray-500 mt-2"},ps={class:"space-y-6"},vs={class:"card"},ms={class:"card-body space-y-3"},gs={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},bs={class:"bg-white rounded-xl p-6 w-full max-w-md"},ys={class:"flex gap-3"},_s={__name:"TaskDetails",setup(fs){const T=U(),e=m(null),p=m(!1),v=m(""),r=m(""),c=async()=>{const{data:a}=await u.get(`/tasks/${T.params.id}`);e.value=a.data},b=async a=>{await u.put(`/tasks/${e.value.id}`,{status:a}),c()},V=async a=>{await u.put(`/task-checklists/${a.id}/toggle`),c()},S=async()=>{await u.post(`/tasks/${e.value.id}/checklists`,{item:v.value}),p.value=!1,v.value="",c()},B=async()=>{r.value.trim()&&(await u.post(`/tasks/${e.value.id}/comments`,{comment:r.value}),r.value="",c())},L=a=>j(a).format("YYYY/MM/DD"),x=a=>j(a).format("YYYY/MM/DD HH:mm"),N=a=>({pending:"قيد الانتظار",in_progress:"جاري",completed:"مكتمل",cancelled:"ملغي"})[a]||a,q=a=>({pending:"badge-gray",in_progress:"badge-info",completed:"badge-success",cancelled:"badge-danger"})[a]||"badge-gray",z=a=>({urgent:"عاجل",high:"مرتفع",medium:"متوسط",low:"منخفض"})[a]||a,F=a=>({urgent:"badge-danger",high:"badge-warning",medium:"badge-info",low:"badge-gray"})[a]||"badge-gray";return H(c),(a,t)=>{var k,_,h,w;return e.value?(d(),o("div",E,[s("div",I,[s("div",null,[s("h2",R,n(e.value.title),1),s("p",A,n((k=e.value.project)==null?void 0:k.name),1)]),s("div",G,[s("span",{class:f([F(e.value.priority),"badge text-base px-4 py-2"])},n(z(e.value.priority)),3),s("span",{class:f([q(e.value.status),"badge text-base px-4 py-2"])},n(N(e.value.status)),3)])]),s("div",J,[s("div",K,[s("div",O,[t[15]||(t[15]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"التفاصيل")],-1)),s("div",P,[e.value.description?(d(),o("p",Q,n(e.value.description),1)):i("",!0),s("div",W,[s("div",null,[t[7]||(t[7]=s("span",{class:"text-gray-500"},"المسؤول:",-1)),t[8]||(t[8]=g()),s("span",X,n(((_=e.value.assignee)==null?void 0:_.name)||"-"),1)]),s("div",null,[t[9]||(t[9]=s("span",{class:"text-gray-500"},"تاريخ الاستحقاق:",-1)),t[10]||(t[10]=g()),s("span",Z,n(e.value.due_date?L(e.value.due_date):"-"),1)]),s("div",null,[t[11]||(t[11]=s("span",{class:"text-gray-500"},"أنشأها:",-1)),t[12]||(t[12]=g()),s("span",ss,n((h=e.value.creator)==null?void 0:h.name),1)]),s("div",null,[t[13]||(t[13]=s("span",{class:"text-gray-500"},"تاريخ الإنشاء:",-1)),t[14]||(t[14]=g()),s("span",ts,n(x(e.value.created_at)),1)])])])]),s("div",es,[s("div",as,[t[16]||(t[16]=s("h3",{class:"font-semibold"},"قائمة المهام",-1)),s("button",{onClick:t[0]||(t[0]=l=>p.value=!0),class:"btn btn-sm btn-primary"},"إضافة")]),s("div",ls,[((w=e.value.checklists)==null?void 0:w.length)===0?(d(),o("div",ns,"لا توجد عناصر")):(d(),o("div",os,[(d(!0),o(C,null,$(e.value.checklists,l=>(d(),o("div",{key:l.id,class:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded"},[s("input",{type:"checkbox",checked:l.is_completed,onChange:y=>V(l),class:"rounded text-primary-600"},null,40,ds),s("span",{class:f({"line-through text-gray-400":l.is_completed})},n(l.item),3)]))),128))]))])]),s("div",is,[t[18]||(t[18]=s("div",{class:"card-header flex items-center justify-between"},[s("h3",{class:"font-semibold"},"التعليقات")],-1)),s("div",rs,[(d(!0),o(C,null,$(e.value.comments,l=>{var y;return d(),o("div",{key:l.id,class:"p-3 bg-gray-50 rounded-lg"},[s("p",cs,n(l.comment),1),s("p",us,n((y=l.user)==null?void 0:y.name)+" - "+n(x(l.created_at)),1)])}),128)),s("form",{onSubmit:D(B,["prevent"]),class:"flex gap-3"},[M(s("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),type:"text",class:"form-input flex-1",placeholder:"أضف تعليق..."},null,512),[[Y,r.value]]),t[17]||(t[17]=s("button",{type:"submit",class:"btn btn-primary"},"إرسال",-1))],32)])])]),s("div",ps,[s("div",vs,[t[19]||(t[19]=s("div",{class:"card-header"},[s("h3",{class:"font-semibold"},"تغيير الحالة")],-1)),s("div",ms,[e.value.status==="pending"?(d(),o("button",{key:0,onClick:t[2]||(t[2]=l=>b("in_progress")),class:"btn btn-primary w-full"},"بدء العمل")):i("",!0),e.value.status==="in_progress"?(d(),o("button",{key:1,onClick:t[3]||(t[3]=l=>b("completed")),class:"btn btn-success w-full"},"إكمال المهمة")):i("",!0),e.value.status!=="cancelled"?(d(),o("button",{key:2,onClick:t[4]||(t[4]=l=>b("cancelled")),class:"btn btn-danger w-full"},"إلغاء")):i("",!0)])])])]),p.value?(d(),o("div",gs,[s("div",bs,[t[21]||(t[21]=s("h3",{class:"text-lg font-semibold mb-4"},"إضافة عنصر",-1)),s("form",{onSubmit:D(S,["prevent"]),class:"space-y-4"},[M(s("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>v.value=l),class:"form-input",placeholder:"العنصر",required:""},null,512),[[Y,v.value]]),s("div",ys,[t[20]||(t[20]=s("button",{type:"submit",class:"btn btn-primary"},"حفظ",-1)),s("button",{type:"button",onClick:t[6]||(t[6]=l=>p.value=!1),class:"btn btn-secondary"},"إلغاء")])],32)])])):i("",!0)])):i("",!0)}}};export{_s as default};
