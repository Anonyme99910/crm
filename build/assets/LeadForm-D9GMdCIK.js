import{g as k,h as S,a as g,r as j,n as q,c as m,b as e,t as v,w as M,e as a,v as n,y as b,z as N,F as T,p as B,i as F,k as L,l as C,q as d,f as D,o as f,s as E}from"./app-Cs6lHxPq.js";const R={class:"max-w-3xl"},$={class:"card"},c={class:"card-header"},z={class:"font-semibold text-gray-900"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},A=["value"],G={class:"flex items-center gap-4"},H=["disabled"],K={__name:"LeadForm",setup(I){const i=S(),w=D(),u=k(()=>!!i.params.id),r=g(!1),y=g([]),t=j({name:"",phone:"",email:"",whatsapp:"",address:"",source:"other",status:"cold",stage:"new",assigned_to:null,notes:"",project_type:"",estimated_budget:null,expected_close_date:""}),x=async()=>{if(u.value)try{const{data:o}=await d.get(`/leads/${i.params.id}`);Object.assign(t,o.data)}catch(o){console.error(o)}},V=async()=>{try{const{data:o}=await d.get("/users-sales-team");y.value=o.data}catch(o){console.error(o)}},U=async()=>{var o,l;r.value=!0;try{u.value?await d.put(`/leads/${i.params.id}`,t):await d.post("/leads",t),w.push("/leads")}catch(p){alert(((l=(o=p.response)==null?void 0:o.data)==null?void 0:l.message)||"حدث خطأ")}finally{r.value=!1}};return q(()=>{x(),V()}),(o,l)=>{const p=C("router-link");return f(),m("div",R,[e("div",$,[e("div",c,[e("h3",z,v(u.value?"تعديل بيانات العميل":"إضافة عميل جديد"),1)]),e("form",{onSubmit:M(U,["prevent"]),class:"card-body space-y-6"},[e("div",O,[e("div",null,[l[12]||(l[12]=e("label",{class:"form-label"},"الاسم *",-1)),a(e("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>t.name=s),type:"text",class:"form-input",required:""},null,512),[[n,t.name]])]),e("div",null,[l[13]||(l[13]=e("label",{class:"form-label"},"رقم الهاتف *",-1)),a(e("input",{"onUpdate:modelValue":l[1]||(l[1]=s=>t.phone=s),type:"tel",class:"form-input",dir:"ltr",required:""},null,512),[[n,t.phone]])]),e("div",null,[l[14]||(l[14]=e("label",{class:"form-label"},"البريد الإلكتروني",-1)),a(e("input",{"onUpdate:modelValue":l[2]||(l[2]=s=>t.email=s),type:"email",class:"form-input",dir:"ltr"},null,512),[[n,t.email]])]),e("div",null,[l[15]||(l[15]=e("label",{class:"form-label"},"واتساب",-1)),a(e("input",{"onUpdate:modelValue":l[3]||(l[3]=s=>t.whatsapp=s),type:"tel",class:"form-input",dir:"ltr"},null,512),[[n,t.whatsapp]])]),e("div",null,[l[17]||(l[17]=e("label",{class:"form-label"},"المصدر *",-1)),a(e("select",{"onUpdate:modelValue":l[4]||(l[4]=s=>t.source=s),class:"form-input",required:""},[...l[16]||(l[16]=[N('<option value="whatsapp">واتساب</option><option value="ads">إعلانات</option><option value="call">مكالمات</option><option value="website">موقع</option><option value="referral">إحالة</option><option value="other">أخرى</option>',6)])],512),[[b,t.source]])]),e("div",null,[l[19]||(l[19]=e("label",{class:"form-label"},"الحالة",-1)),a(e("select",{"onUpdate:modelValue":l[5]||(l[5]=s=>t.status=s),class:"form-input"},[...l[18]||(l[18]=[e("option",{value:"cold"},"بارد",-1),e("option",{value:"warm"},"دافئ",-1),e("option",{value:"hot"},"ساخن",-1)])],512),[[b,t.status]])]),e("div",null,[l[20]||(l[20]=e("label",{class:"form-label"},"نوع المشروع",-1)),a(e("input",{"onUpdate:modelValue":l[6]||(l[6]=s=>t.project_type=s),type:"text",class:"form-input",placeholder:"شقة، فيلا، مكتب..."},null,512),[[n,t.project_type]])]),e("div",null,[l[21]||(l[21]=e("label",{class:"form-label"},"الميزانية المتوقعة",-1)),a(e("input",{"onUpdate:modelValue":l[7]||(l[7]=s=>t.estimated_budget=s),type:"number",class:"form-input",min:"0"},null,512),[[n,t.estimated_budget]])]),e("div",null,[l[23]||(l[23]=e("label",{class:"form-label"},"المسؤول",-1)),a(e("select",{"onUpdate:modelValue":l[8]||(l[8]=s=>t.assigned_to=s),class:"form-input"},[l[22]||(l[22]=e("option",{value:null},"-- اختر --",-1)),(f(!0),m(T,null,B(y.value,s=>(f(),m("option",{key:s.id,value:s.id},v(s.name),9,A))),128))],512),[[b,t.assigned_to]])]),e("div",null,[l[24]||(l[24]=e("label",{class:"form-label"},"تاريخ الإغلاق المتوقع",-1)),a(e("input",{"onUpdate:modelValue":l[9]||(l[9]=s=>t.expected_close_date=s),type:"date",class:"form-input"},null,512),[[n,t.expected_close_date]])])]),e("div",null,[l[25]||(l[25]=e("label",{class:"form-label"},"العنوان",-1)),a(e("textarea",{"onUpdate:modelValue":l[10]||(l[10]=s=>t.address=s),class:"form-input",rows:"2"},null,512),[[n,t.address]])]),e("div",null,[l[26]||(l[26]=e("label",{class:"form-label"},"ملاحظات",-1)),a(e("textarea",{"onUpdate:modelValue":l[11]||(l[11]=s=>t.notes=s),class:"form-input",rows:"3"},null,512),[[n,t.notes]])]),e("div",G,[e("button",{type:"submit",disabled:r.value,class:"btn btn-primary"},v(r.value?"جاري الحفظ...":"حفظ"),9,H),F(p,{to:"/leads",class:"btn btn-secondary"},{default:L(()=>[...l[27]||(l[27]=[E("إلغاء",-1)])]),_:1})])],32)])])}}};export{K as default};
